{% extends "base.xhtml" %}
{% load i18n plmapp_tags %}


{% block title %}
    {% if obj.is_document or obj.is_part %}
        {{ obj.type }}-{{ obj.reference }}-{{ obj.revision }}
    {% else %}
        {{ obj.get_full_name }} {{ obj.username }}
        {{ obj.name }}
    {% endif %}
{% endblock %}

{% block page_title %}
    BOM {{ obj.type }} // {{ obj.reference }} // {{ obj.revision }} // {{obj.name}}
{% endblock %}

{% block content %}
    <div>
        <p> BOM at {{date|date:"DATETIME_FORMAT"}} </p>
    </div>

    <div>

        <table class="Content">
            <tr class="Content">
                <th class="Content" style="width:50px"> {% trans "Level" %} </th>
                <th class="Content" style="width:50px"> {% trans "Ord." %} </th>
                <th class="Content" style="width:50px"> {% trans "Qty" %}</th>
                <th class="Content" style="width:50px"> {% trans "Unit" %}</th>
                <th class="Content"> {{ obj.reference }} </th>
                <th class="Content"> {{ obj.revision }} </th>
                <th class="Content"> {{ obj.type }} </th>
                <th class="Content"> {{ obj.name }} </th>
                {% for field, verbose_name in extra_columns %}
                    <th class="Content"> {{ verbose_name|capfirst }} </th>
                {% endfor %}
                <th class="Content"> {{ obj.state.name }} </th>
            </tr>
            {% for c in children %}

                <tr class="Content"> 
                    <td class="Content level{{c.level}}" style="padding-left:{{c.level|add:"-1"}}0px;" >
                        <span >{{c.level}}</span>
                    </td>
                    {% with c.link as link %}
                        <td class="Content"> {{ link.order }} </td>
                        <td class="Content"> {{ link.quantity }} </td>
                        <td class="Content"> {{ link.get_unit_display }} </td>
                        {% with link.child as child %}
                            <td class="Content"> {{ child.reference }} </td>
                            <td class="Content"> {{ child.revision }} </td>
                            <td class="Content"> {{ child.type }} </td>
                            <td class="Content"> {{ child.name }} </td>
                            {% for field, verbose_name in extra_columns %}
                                <td class="Content"> {{ extension_data|key:link.id|key:field }} </td>
                            {% endfor %}
                            <td class="Content"> {{ child.state.name }} </td>
                        {% endwith %}
                    {% endwith %}
                </tr>
            {% endfor %}
        </table>
    </div>


{% endblock %}
