{% extends "base.html" %}
{% load i18n plmapp_tags highlight %}

{# browse page #}

{% block css %}
{% endblock %}
{% block leftcolumn %} {% endblock %}

{% block content %}
    <div id="browser">
        {% block browse-left-panel %}
            <div id="type-panel">
                {% block browse-type %}
                    <div>
                        <h3 class="alternate">{% trans "Type" %} </h3>
                    </div>
                    <ul>
                        <li {% if type == "object"%}class="selected"{% endif %} >
                        <a href="/browse/object/{% add_get page='1'%}"><span>{% trans "Objects" %}</span></a>
                        </li>
                        <li {% if type == "part"%}class="selected"{% endif %} >
                        <a href="/browse/part/{% add_get page='1'%}"><span style="padding-left:1em;" >{% trans "Parts" %}</span></a>
                        </li>
                        <li {% if type == "topassembly"%}class="selected"{% endif %} >
                        <a href="/browse/topassembly/{% add_get page='1'%}"><span style="padding-left:2em;" >{% trans "Top assemblies" %}</span></a>
                        </li>
                        <li {% if type == "document"%}class="selected"{% endif %} >
                        <a href="/browse/document/{% add_get page='1'%}"><span style="padding-left:1em;" >{% trans "Documents" %}</span></a>
                        </li>
                        {% if not restricted %}
                            <li {% if type == "group"%}class="selected"{% endif %} >
                            <a href="/browse/group/{% add_get page='1'%}"><span>{% trans "Groups" %}</span></a></li>
                            <li {% if type == "user"%}class="selected"{% endif %} >
                            <a href="/browse/user/{% add_get page='1'%}"><span>{% trans "Users" %}</span></a>
                            </li>
                        {% endif %}
                        {% if request.user.is_authenticated %}
                            {% for etype in extra_types %}
                                <li {% if type == etype%}class="selected"{% endif %} >
                                <a href="/browse/{{etype.lower}}/{% add_get page='1'%}"><span>{{ etype }}</span></a>
                                </li>
                            {% endfor %}
                        {% endif %}
                    </ul>
                {% endblock %}
                {% block browse-sort %}
                    <div>
                        <h3 class="alternate">{% trans "Sort" %} </h3>
                    </div>
                    <ul>
                        <li {% if sort == "recently-added"%}class="selected"{% endif %} > 
                        <a href="{% add_get sort='recently-added' %}"><span>{% trans "Recently added" %}</span></a>
                        </li>
                        <li {% if sort == "name"%}class="selected"{% endif %} >
                        <a href="{% add_get sort='name' %}"><span>{% trans "Sorted by name" %}</span></a>
                        </li>
                        {% if type == "part" or type == "topassembly" %}
                            <li {% if sort == "children"%}class="selected"{% endif %} >
                            <a href="{% add_get sort='children' %}"><span>{% trans "Largest assemblies" %}</span></a>
                            </li>
                        {% endif %}
                        {% if type == "part" %}
                            <li {% if sort == "most-used"%}class="selected"{% endif %} >
                            <a href="{% add_get sort='most-used' %}"><span>{% trans "Most used" %}</span></a>
                            </li>
                        {% endif %}
                    </ul>
                {% endblock %}
                {% block browse-state %}
                    {% if plmobjects and not restricted %}
                        <div>
                            <h3 class="alternate">{% trans "State" %} </h3>
                        </div>
                        <ul>
                            <li {% if state == "all"%}class="selected"{% endif %} >
                            <a href="{% add_get state='all' %}"><span>{% trans "All states" %}</span></a>
                            </li>
                            <li {% if state == "official"%}class="selected"{% endif %} >
                            <a href="{% add_get state='official' %}"><span>{% trans "Official state" %}</span></a>
                            </li>
                            <li {% if state == "published"%}class="selected"{% endif %} >
                            <a href="{% add_get state='published' %}"><span>{% trans "Published" %}</span></a>
                            <li>
                        </ul>
                    {% endif %}
                {% endblock %}

            </div>
        {% endblock %}
        {% block browse-results %}
            <div id="browse-results">
                <h3>{% trans "Results" %}</h3>
                <div id="object_list">
                    <p id="results">
                    {% block sort-method %}
                        <span id="sort_method">
                            {% if sort == "name" %}
                                {% trans "Sorted by name" %}.
                            {% else %}
                                {% if type in "part topassembly" and sort == "children" %}
                                    {% trans "Largest assemblies" %}.
                                {% else %}
                                    {% if type == "part" and sort == "most-used" %}
                                        {% trans "Most used" %}.
                                    {% else %}
                                        {% trans "Recently added" %}.
                                    {% endif %}
                                {% endif %}
                            {% endif %}
                        </span>
                    {% endblock %}
                    {% block selected-state %}
                        {% if plmobjects %}
                            <span id="state_filter">
                                {% if state == "official" %}
                                    {% trans "Only official objects" %}.
                                {% else %}
                                    {% if state == "published" %}
                                        {% trans "Only published objects" %}.
                                    {% else %}
                                        {% trans "All objects"%}.
                                    {% endif %}
                                {% endif %}
                            </span>
                        {% endif %}
                    {% endblock %}
                    {% trans "Results" %}
                    <span id="numresults">
                        {% blocktrans with objects.start_index as start and objects.end_index as end and objects.paginator.count as total %}
                            ({{start}} - {{end}} on {{total}})
                        {% endblocktrans %}
                    </span> 
                    </p>
                    {% block browse-objects %}

                        {% with restricted|yesno:"public/," as suffix_url %}

                            {% for object in objects.object_list %}
                                {% with object|main_type|add:"s/identity_card.html" as tpl %}
                                    {% include tpl %}
                                {% endwith %}
                            {% endfor %}
                        {% endwith %}
                    {% endblock %}
                </div>

                {% show_pages_bar objects request %}
            </div>
        {% endblock %}
    </div>
{% endblock %}
